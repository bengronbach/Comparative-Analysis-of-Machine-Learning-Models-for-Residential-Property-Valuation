Imports 

import pandas as pd import numpy as np import matplotlib.pyplot as plt from sklearn.model_selection import train_test_split from sklearn.ensemble import RandomForestRegressor from sklearn.metrics import mean_squared_error, mean_absolute_error, r2_score from sklearn.preprocessing import OneHotEncoder from sklearn.compose import ColumnTransformer from sklearn.pipeline import Pipeline 

Load dataset 

file_path = '/Users/ryansmith/Desktop/housing.csv' df = pd.read_csv(file_path) df = df.dropna() 

Define target values 

target_column = 'price' # change this if your CSV uses a different column name X = df.drop(columns=[target_column]) y = df[target_column] 

Sort Columns 

cat_cols = X.select_dtypes(include=['object', 'category']).columns num_cols = X.select_dtypes(include=['number']).columns 

Preprocess Data 

preprocessor = ColumnTransformer( transformers=[ ('num', 'passthrough', num_cols), ('cat', OneHotEncoder(handle_unknown='ignore'), cat_cols) ] ) 

Create Random Forest model 

rf = Pipeline(steps=[ ('preprocessor', preprocessor), ('regressor', RandomForestRegressor( n_estimators=200, random_state=42, n_jobs=-1 )) ]) 

Split data  

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42) 

Train the model  

print("Training Random Forest Model...") rf.fit(X_train, y_train) 

 Predict on test data 

y_pred = rf.predict(X_test) 

 Evaluate performance  

r2 = r2_score(y_test, y_pred) mae = mean_absolute_error(y_test, y_pred) rmse = np.sqrt(mean_squared_error(y_test, y_pred)) 

print(f"\n Model Evaluation:") print(f"R² Score: {r2:.3f}") print(f"MAE: {mae:,.2f}") print(f"RMSE: {rmse:,.2f}") 

 Easy-to-read scatter plot 

plt.figure(figsize=(7, 7)) plt.scatter(y_test, y_pred, color='skyblue', edgecolor='k', alpha=0.6, label='Predicted Houses') 

Add red "perfect prediction" line 

max_val = max(max(y_test), max(y_pred)) min_val = min(min(y_test), min(y_pred)) plt.plot([min_val, max_val], [min_val, max_val], color='red', linewidth=2, label='Perfect Prediction') 

plt.title(f'Actual vs Predicted House Prices\nR²={r2:.3f}, MAE=${mae:,.0f}, RMSE=${rmse:,.0f}', fontsize=13, fontweight='bold') plt.xlabel('Actual Price', fontsize=12) plt.ylabel('Predicted Price', fontsize=12) plt.legend() plt.grid(True, linestyle='--', alpha=0.6) plt.tight_layout() plt.show() 
